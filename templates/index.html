{% extends "layout.html" %}
{% block header %}
<div class="jumbotron jumbotron-fluid bg-white text-center">
  <div class="container-fluid">
    <h1 class="display-4">A good title</h1>
    <p class="lead">A visual debugging tool for fine-tuned transformer models for (mutli-label) sequence classification tasks</p>
  </div>
</div>
{% endblock %}

{% block content %}

<div id="spinning-overlay">
  <div id="spinner-container">
    <div class="text-center">
      <div class="spinner-grow text-primary" role="status" id="spinner">
        <span class="sr-only">Loading...</span>
      </div>
      <p class="spinning-info">
        Calculating sentiment and fitting UMAP model ...
      </p>
    </div>
  </div>
</div>
<div class="row">
	<div class="col-md-5">
    <h2 style="padding-left: 60px;">Projection of sentence embeddings</h2>
    <div class="row badge-legend">
      <span class="badge badge-pill class-neutral">
        neutral
      </span>
      <span class="badge badge-pill class-positive">
        positive
      </span>
      <span class="badge badge-pill class-negative">
        negative
      </span>
    </div>
		<div id="plot"></div>
	</div>
  <div class="col-md-3">
    <div id="self-attention-heatmap"></div>
  </div>
	<div class="col-md-4">
    <h2>Meta</h2>
    <div class="card" style=" min-height: 100px;">
      <div class="card-body">
        <h5 class="card-title">Datapoint</h5>
        <h6 class="card-subtitle mb-2 text-muted">Your current selection</h6>
        <p class="card-text" id="point-data">
          Select a point to see its data here and to interact with the self-attention!
        </p>
        <hr />
        <!-- ', '#64abe5', '#9e64e5 -->
        <div id="user-classification">
          <div class="row">
            <div class="col-8">
              <div class="form-group">
                <label for="sentiment-classes-user-classification">Select the fitting sentiment class, if wrongly classified.</label>
                <select class="form-control" id="sentiment-classes-user-classification">
                  <option value="positive">Positive</option>
                  <option value="neutral">Neutral</option>
                  <option value="negative">Negative</option>
                </select>
              </div>
            </div>
            <div class="col-4">
              <a href="#confirm-user-classification-sentiment" id="confirm-user-classification-sentiment" name="confirm-user-classification-sentiment" class="btn btn-outline-primary">Confirm</a>
            </div>
          </div>
        </div>
        <hr />
        <div id="self-attention-interaction">

          <div class="row">
            <div class="col-6">
              <label for="segment-attention">Show an self-attention heatmap for the selected datapoint</label>
            </div>
            <div class="col-6">
              <div class="row">
                <div class="col-6">
                  <input class="form-control" type="number" min="1" max="12" id="layer_input" name="layer_input" value="1" aria-describedby="layer_input_help"/>
                  <small id="layer_input_help" class="form-text text-muted">Layer (1-12)</small>
                </div>
                <div class="col-6">
                  <input class="form-control" type="number" min="1" max="12" id="head_input" name="head_input" value="1" aria-describedby="head_input_help"/>
                  <small id="head_input_help" class="form-text text-muted">Head (1-12)</small>
                </div>
              </div>
              <br />
              <a class="btn btn-fluid btn-outline-warning" href="#segment-self-attention" id="segment-attention" name="segment-attention">Show Self-Attention</a> <br />
            </div>
          </div>
          <br />
          <div class="row">
            <div class="col-6">
              <label for="explore-neighbours">Show self-attention heatmaps datapoints near the selected</label>
            </div>
            <div class="col-6">
              <div class="row">
                <div class="col-6">
                  <input class="form-control" type="number" min="1" max="12" id="layer_input_neighbours" name="layer_input_neighbours" value="1" aria-describedby="layer_input_neighbours_help"/>
                  <small id="layer_input_neighbours_help" class="form-text text-muted">Layer (1-12)</small>
                </div>
                <div class="col-6">
                  <input class="form-control" type="number" min="1" max="12" id="head_input_neighbours" name="head_input_neighbours" value="1" aria-describedby="head_input_neighbours_help"/>
                  <small id="head_input_neighbours_help" class="form-text text-muted">Head (1-12)</small>
                </div>
              </div>
              <br />
              <a class="btn btn-outline-warning" href="#explore-neighbours" id="explore-neighbours" name="explore-neighbours">Neighbourhood Self-Attention</a>
            </div>
          </div>

        </div>
      </div>
    </div>
    <br />

    <div class="row rules">

      <br />
      <div class="col-md-6 col-sm-12">

        <div class="card" style="">
          <div class="card-body">
            <h5 class="card-title">Split-Rule</h5>
            <!-- <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6> -->
            <p class="card-text">
              <label>
                <!-- for="split-rule"> -->
                Split the sentence in sub-sentences and plot the embeddings of each sentence
              </label>
              <button id="split-rule" name="split-rule" type="button" class="btn btn-outline-primary btn-block">Split</button>
            </p>
          </div>
        </div>
      </div>

  		<!-- <br /> -->

      <div class="col-md-6 col-sm-12">
    		<div class="card">
    		  <div class="card-body">
    		    <h5 class="card-title">Test-Rule</h5>
    		    <!-- <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6> -->
    		    <p class="card-text">
    					<label>
    						 Enter your own sentence, plot it and get the predicted sentiment.
    					</label>
    					<textarea class="form-control" maxlength="150" id="test-rule-segment" name="test-rule-segment" rows="3"/></textarea> <br />
    					<button id="test-rule" name="test-rule" type="button" class="btn btn-outline-primary btn-block">Go</button>
    				</p>
    		  </div>
    		</div>
      </div>

    </div>

		<br />
	</div>

</div>
{% endblock %}
